<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<head>
<title>Page Title</title>
<style>
.myDivHeader {
  border: 5px outset red;
  background-color: lightblue;
  text-align: center;
}
.myDivStateChart {
  border: 5px outset black;
  background-color: white;
  text-align: center;
}

.myDivDailyChart {
  border: 5px outset green;
  background-color: white;
  text-align: center;

}
.myDivBarChart {
  border: 5px outset green;
  background-color: white;
  text-align: center;

}
circle {fill: lightblue; stroke: black;} 

</style>
</head>

<body>
<div class="myDivHeader">
  <h2>Visualization of Covid Cases in United States by STATE and County</h2>
  <p> Select the states to see the trends</p>
</div>
<div class=  myDivDailyChart>
  <h2>US Cases Daily Trend  </h2>
  <svg width=1400 height=360>
  
    <script>
       src="dailyChart.js"
    </script>
  </svg>
</div>
<div class="myDivStateChart" >
  <h2>US STATE COVID Cases  </h2>
  <svg width=1400 height=360>
  </svg>
  <script>                  
    
        //const data = d3.csv('https://raw.githubusercontent.com/SathishRama/srama.github.io/master/us-states.csv')
        var marginx = 50;
        var marginy = 100;
        const data = d3.csv('https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv')
        .then(function(data){            
              var statecounts = d3.nest()
                  .key(function(d) {return d.state }).sortKeys(d3.ascending)
                  .rollup(function(v) { return d3.max( v, function(d) { return parseInt(d.cases)})})
                  .entries(data);           
              var statelist = [] ;
              var statecases = [] ;
              var k = 0 ;
              
              statecounts.forEach( function(each) {
                statelist[k] = each.key ;
                statecases[k] = each.value ;
                k++ ;
                //console.log(each.key , each.value);
              });                          
              
              colorScale = d3.scaleLinear().domain([0,d3.max(statecases)]).range(["lightblue","red"]);             
              xs = d3.scaleBand().domain(statelist).range([0,1300]);
              ys = d3.scaleLinear().domain([0,d3.max(statecases)]).range([200,0]);

              d3.select(".myDivStateChart").select("svg").append("g")
                .attr("transform","translate(50,50)")
                .call(d3.axisLeft(ys));
              d3.select(".myDivStateChart").select("svg").append("g")
                .attr("transform","translate(50,250)")
                .call(d3.axisBottom(xs))
                .selectAll("text") 
                  .style("text-anchor", "end")
                  .attr("dx", "-.8em")
                  .attr("dy", ".15em")
                  .attr("transform", "rotate(-65)");

              d3.select(".myDivStateChart").select("svg")
                .append('g').attr("transform","translate(50,50)")
                .selectAll('rect')
                //.append("path")
                .data(statecounts)
                .enter()
                .append('rect')
                  .attr('x',function(d,i) {return xs(d.key)})
                  .attr('y',function(d,i) {return ys(d.value)})
                  //.attr('y',function(d,i) {return (100)})
                  .attr('width',xs.bandwidth())
                  .attr('height',function(d) {return (200 - ys(d.value))})
                  .attr('fill', function(d) {return (colorScale(d.value))})
                  .attr('stroke','black');
                  // line chart attr's
                  //.attr("d",d3.line()
                  //            .x(function(d,i) {return xs(d.keys)})
                  //            .y(function(d,i) {return ys(d.values)})
                  //  )
                  //.attr('fill','lightblue')
                  //.attr('stroke-width',2)
                  //.attr('stroke','black');

        })
        .catch(function() {
              console.log(Error)
        });
           
  </script>
</div>



<div class=  myDivBarChart>
  <h2>This is for Bar chart </h2>
  <svg width=300 height=300>
  
    <script>
       const data1 = d3.csv('https://raw.githubusercontent.com/SathishRama/srama.github.io/master/data.csv')
        .then(function(data1){
              xdomain = ['7/1/2020','7/2/2020','7/3/2020','7/4/2020','7/5/2020'];       
              xs = d3.scaleBand().domain(xdomain).range([0,200]);
              ys = d3.scaleLinear().domain([0,30]).range([200,0]);
                    
              //console.log(data1) 
              d3.select(".myDivBarChart").select("svg").append("g")
                .attr("transform","translate(50,50)")
                .call(d3.axisLeft(ys));
              
              d3.select(".myDivBarChart").select("svg").append("g")
                .attr("transform","translate(50,250)")
                .call(d3.axisBottom(xs));
              
              d3.select(".myDivBarChart").select("svg")
                .append('g').attr("transform","translate(50,50)")
                .selectAll('rect')
                .data(data1)
                .enter()
                .append('rect')
                  .attr('x',function(d,i) {return xs(d.date)})
                  //.attr('y',function(d,i) {return ys(d.counts)})
                  .attr('y',function(d,i) {return ys((d.counts))})
                  .attr('width',xs.bandwidth())
                  .attr('height',function(d) {return (200 - ys((d.counts)))})
                  .attr('fill','blue').attr('stroke','black');

        })
        .catch(function() {
              console.log("Error loading file")
        });
    </script>
  </svg>
</div>


</body>
</html>